---
description: Entry point into Server Guide â€” structure and architecture for DartWay backends
alwaysApply: true
---

# Server Project Structure

This document is the **entry point into the Server Guide**.  
It defines how to organize a DartWay backend project (based on Serverpod) and connects to more detailed guides:
- [Models](./defining_models)
- [CRUD Configs](./crud_configs)
- (upcoming) Event Models & Migrations

---

## ðŸŽ¯ Core Principles

- **Domain-first** â†’ everything starts from models.  
- **CRUD-only** â†’ all logic goes through CRUD configs, not custom endpoints.  
- **Consistency** â†’ predictable patterns for every feature.  
- **AI-friendly** â†’ assistants can generate backend code safely.  

---

## ðŸ“‚ Recommended Project Layout

```yaml
server/
â”œâ”€ lib/
â”‚  â””â”€ src/
â”‚     â”œâ”€ app/         # application services, scenarios, workflows (session-aware)
â”‚     â”œâ”€ crud/        # CRUD configs per model (Save, Delete, Get)
â”‚     â”œâ”€ dartway/     # DartWay core utilities for server
â”‚     â”œâ”€ domain/      # pure domain extensions on models (no session, no IO)
â”‚     â”œâ”€ endpoints/   # (rare) custom endpoints
â”‚     â”œâ”€ generated/   # serverpod generated code (do not edit)
â”‚     â”œâ”€ models/      # YAML model definitions
â”‚     â””â”€ web/         # serverpod web entry (keep minimal)
â””â”€ server.dart        # entry point for the server
```

---

## ðŸ“¦ Folders Explained

- **/app** â†’ application-level workflows and services.  
  Session-aware, may call external APIs, send notifications, orchestrate flows.  
  Can be invoked from CRUD configs, event models, or webhooks.  

- **/crud** â†’ contains CRUD configs (`SaveConfig`, `DeleteConfig`, `GetModelConfig`, `GetListConfig`).  
  Place all validation, access control, pre/post-processing, and side effects here.  

- **/dartway** â†’ internal DartWay backend utilities (core building blocks).  

- **/domain** â†’ pure business rules as extensions on models.  
  No dependencies on `Session`, no calls to external APIs, no persistence.  
  Example: `UserProfile.hasPremiumAccess` computed from model fields.  

- **/endpoints** â†’ avoid creating them unless absolutely necessary (file upload, webhooks).  

- **/generated** â†’ auto-generated Serverpod code. Never edit manually.  

- **/models** â†’ all entities defined in `.yaml` files.  
  This is the single source of truth for schema and sync with frontend.  

- **/web** â†’ serverpod web support folder. Keep minimal.  

- **/test** â†’ backend unit and integration tests (outside of `lib/`).  

---

## ðŸš¦ Workflow Overview

1. Define or update a **model** in `/models`.  
2. Run `serverpod generate` to update generated code.  
3. Create or update a migration:  
   ```bash
   dart run serverpod create-migration
   ```
   :::warning
   If there are conflicts or schema resets, you may need `--force`.  
   Use `--force` only when you are sure previous migrations can be overwritten (e.g. early MVP stage).  
   :::
4. Configure CRUD logic in `/crud`.  
   - Add validation, access control, pre/post processing.  
5. Extend logic in `/domain` (pure) or `/app` (session-aware workflows).  
6. Apply migrations with:  
   ```bash
   dart run serverpod migrate
   ```
7. Add tests.  

---

## âœ… Key Takeaways

- Models are the foundation â†’ everything starts there.  
- CRUD configs are the central place for backend logic.  
- **Domain = pure extensions, no dependencies.**  
- **App = workflows & services, session-aware.**  
- Migrations must be created and applied after model changes (`--force` only in safe cases).  
- Endpoints are last resort.  
- Tests are mandatory.  
